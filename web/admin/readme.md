# Hard security
web, 200 points

> Админ заходит только из локальной сети GoGo. Мы узнали его IP-адрес: 10.8.0.111. Его уволили и теперь он не может зайти в админку. А ты?

## Write-up

Заходим на сайт, получаем ошибку 403. Как же притвориться, что наш IP — 10.8.0.111. Этот IP находится в локальной сети, поэтому к нему мы точно не сможем получить доступ.

Тут легко решали таск те, кто вспоминал, как работают прокси. Чтобы дать возможность серверу определить IP-адрес клиента, они ставят в HTTP-заголовок `X-Real-IP` и `X-Forwarded-For` IP-адрес иницииатора запроса.

А попробуем сделать фейковый заголовок и сказать, что мы как будто являемся прокси-сервером для админа. Это можно, к примеру, сделать с помощью какого-нибудь расширения для браузера или тремя строками на Python:

```python
import requests
r = requests.get("https://admin.upmlctf.ru/", headers={"X-Forwarded-For": "10.8.0.111"})
print(r.text)
```

Кстати, `X-Real-IP` тут не работал, потому что он перезаписывается на моём хосте (сам сервис работает в докере за реверс-прокси).

Флаг: **uctf_untrusted_proxy**